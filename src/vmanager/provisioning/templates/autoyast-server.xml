<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE profile>
<profile xmlns="http://www.suse.com/1.0/yast2ns" 
         xmlns:config="http://www.suse.com/1.0/configns">
    
    <!-- General Settings -->
    <general>
        <mode>
            <confirm config:type="boolean">false</confirm>
            <forceboot config:type="boolean">false</forceboot>
            <final_reboot config:type="boolean">true</final_reboot>
        </mode>
    </general>
    
    <!-- Language and Keyboard -->
    <language>
        <language>{language}</language>
        <languages>{language}</languages>
    </language>
    
    <keyboard>
        <keymap>{keyboard}</keymap>
    </keyboard>
    
    <!-- Timezone -->
    <timezone>
        <hwclock>UTC</hwclock>
        <timezone>{timezone}</timezone>
    </timezone>
    
    <!-- Partitioning -->
    <partitioning config:type="list">
        <drive>
            <device>/dev/vda</device>
            <initialize config:type="boolean">true</initialize>
            <use>all</use>
            <partitions config:type="list">
                <!-- EFI System Partition -->
                <partition>
                    <create config:type="boolean">true</create>
                    <crypt_fs config:type="boolean">false</crypt_fs>
                    <filesystem config:type="symbol">vfat</filesystem>
                    <format config:type="boolean">true</format>
                    <fstopt>umask=0002,utf8=true</fstopt>
                    <loop_fs config:type="boolean">false</loop_fs>
                    <mount>/boot/efi</mount>
                    <mountby config:type="symbol">uuid</mountby>
                    <partition_id config:type="integer">259</partition_id>
                    <partition_nr config:type="integer">1</partition_nr>
                    <resize config:type="boolean">false</resize>
                    <size>512MB</size>
                </partition>
                <!-- Root Partition -->
                <partition>
                    <create config:type="boolean">true</create>
                    <crypt_fs config:type="boolean">false</crypt_fs>
                    <filesystem config:type="symbol">btrfs</filesystem>
                    <format config:type="boolean">true</format>
                    <loop_fs config:type="boolean">false</loop_fs>
                    <mount>/</mount>
                    <mountby config:type="symbol">uuid</mountby>
                    <partition_id config:type="integer">131</partition_id>
                    <partition_nr config:type="integer">2</partition_nr>
                    <resize config:type="boolean">false</resize>
                    <size>max</size>
                </partition>
            </partitions>
        </drive>
    </partitioning>
    
    <!-- Software Selection - Server -->
    <software>
        <patterns config:type="list">
            <pattern>base</pattern>
            <pattern>enhanced_base</pattern>
            <pattern>yast2_basis</pattern>
            <pattern>minimal_base</pattern>
            <pattern>file_server</pattern>
            <pattern>web_server</pattern>
            <pattern>mail_server</pattern>
        </patterns>
        <packages config:type="list">
            <package>qemu-guest-agent</package>
            <package>spice-vdagent</package>
            <package>openssh</package>
            <package>apache2</package>
            <package>nginx</package>
            <package>php</package>
            <package>mariadb</package>
            <package>postgresql</package>
            <package>redis</package>
            <package>samba</package>
            <package>nfs-utils</package>
            <package>postfix</package>
            <package>dovecot</package>
            <package>fail2ban</package>
            <package>firewalld</package>
            <package>rsync</package>
            <package>git</package>
            <package>vim</package>
            <package>curl</package>
            <package>wget</package>
            <package>htop</package>
            <package>tree</package>
            <package>tmux</package>
        </packages>
    </software>
    
    <!-- Network Configuration -->
    <networking>
        <keep_install_network config:type="boolean">true</keep_install_network>
        <interfaces config:type="list">
            <interface>
                <bootproto>dhcp</bootproto>
                <device>eth0</device>
                <startmode>auto</startmode>
            </interface>
        </interfaces>
    </networking>
    
    <!-- Users -->
    <users config:type="list">
        <!-- Root User -->
        <user>
            <username>root</username>
            <user_password>{root_password}</user_password>
            <encrypted config:type="boolean">false</encrypted>
        </user>
        <!-- Regular User -->
        <user>
            <username>{user_name}</username>
            <user_password>{user_password}</user_password>
            <encrypted config:type="boolean">false</encrypted>
            <fullname>{user_name}</fullname>
            <gid>100</gid>
            <home>/home/{user_name}</home>
            <shell>/bin/bash</shell>
            <uid>1000</uid>
        </user>
    </users>
    
    <!-- Services -->
    <services-manager>
        <default_target>multi-user</default_target>
        <services config:type="list">
            <service>
                <service_name>sshd</service_name>
                <service_status>enable</service_status>
            </service>
            <service>
                <service_name>qemu-guest-agent</service_name>
                <service_status>enable</service_status>
            </service>
            <service>
                <service_name>apache2</service_name>
                <service_status>enable</service_status>
            </service>
            <service>
                <service_name>mariadb</service_name>
                <service_status>enable</service_status>
            </service>
            <service>
                <service_name>firewalld</service_name>
                <service_status>enable</service_status>
            </service>
        </services>
    </services-manager>
    
    <!-- Bootloader -->
    <bootloader>
        <loader_type>grub2-efi</loader_type>
        <global>
            <timeout config:type="integer">8</timeout>
        </global>
    </bootloader>
    
    <!-- Host Configuration -->
    <host>
        <hosts config:type="list">
            <hosts_entry>
                <host_address>127.0.0.1</host_address>
                <names config:type="list">
                    <name>localhost</name>
                </names>
            </hosts_entry>
            <hosts_entry>
                <host_address>::1</host_address>
                <names config:type="list">
                    <name>localhost ipv6-localhost ipv6-loopback</name>
                </names>
            </hosts_entry>
        </hosts>
    </host>
    
</profile>